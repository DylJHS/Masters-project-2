---
title: "RNA Analysis PII"
output: html_document
date: "2024-01-07"
---

Part II. Intra-Gene-set & inter-cancer type expression analysis

Reorder the data based on the histology group for readability and interpretation of graph and legend.

```{r}
data_complete <- data %>% arrange(Hist_group) 
unique_Abbrvs <- unique(data_complete$TSS_Abbrvs)
data_complete$TSS_Abbrvs <- factor(data_complete$TSS_Abbrvs, levels = unique_Abbrvs)

``` 

Q1. 
A) Boxplot showing the various distributions of RNA for each cancer type.

```{r}
ggplot(data_complete, aes(x = TSS_Abbrvs, y = Mean_set, fill = Hist_group)) + 
  geom_boxplot() +
  stat_boxplot(geom = "errorbar") +
  theme_minimal() +
  labs(title = "Average Gene-set Expression by Source Tissue Type",
       y = "Log2 Expression",
       fill = "Histology Group") +
  theme(legend.position = "right",
        legend.text = element_text(size= 7),
        axis.text.x = element_text(angle= 90, 
                                   size= 8),
        axis.title.x = element_blank(),
        legend.title =element_text(hjust = 0.5,
                                   size = 11),
        plot.title = element_text(hjust = 0.5,
                                  size = 14),
        panel.grid.major = element_line(color = "black",
                                        linewidth = 0.5,
                                        linetype = 1),
        panel.grid.minor = element_line(color = "black",
                                        linewidth = 0.2,
                                        linetype = 1),
        panel.background = element_rect(fill = "#EDEDED"),
        panel.border = element_rect(fill = "transparent",
                                    color = 1,
                                    linewidth = 2)) 

``` 

B) For the ANOVA test between the groups means, need to test for: Normality of data within each group

```{r}
ggplot(data_complete, aes(x = Mean_set, fill = TSS_Abbrvs)) + 
  geom_histogram(alpha = 0.3, position = "identity") +
  theme_minimal() +
  labs(title = "Histogram of Gene-set Expression by Source Tissue Type",
       y = "Log2 Expression",
       fill = "TSS") +
  theme(legend.position = "right",
        legend.text = element_text(size= 7),
        axis.text.x = element_text(size= 8),
        legend.title =element_text(hjust = 0.5,
                                   size = 11),
        plot.title = element_text(hjust = 0.5,
                                  size = 14),
        panel.grid.major = element_line(color = "black",
                                        linewidth = 0.5,
                                        linetype = 1),
        panel.grid.minor = element_line(color = "black",
                                        linewidth = 0.2,
                                        linetype = 1),
        panel.background = element_rect(fill = "#EDEDED"),
        panel.border = element_rect(fill = "transparent",
                                    color = 1,
                                    linewidth = 2)) 
```

```{r}
ggplot(data_complete, aes(sample= Mean_set, color = TSS)) +
  stat_qq() + 
  stat_qq_line() +
  facet_wrap(~TSS) + 
  theme(
    legend.position = "None",
    axis.text.x = element_text(size= 10),
    plot.title = element_text(hjust = 0.5,
                              size = 19),
    panel.grid.major = element_line(color = "black",
                                    linewidth = 0.5,
                                    linetype = 1),
    panel.grid.minor = element_line(color = "black",
                                    linewidth = 0.2,
                                    linetype = 1),
    panel.background = element_rect(fill = "#EDEDED"),
    panel.border = element_rect(fill = "transparent",
                                color = 1,
                                linewidth = 2)
  ) 
```

C) For the ANOVA test between the groups means, need to test for: Homoscedasticity of data within each group 

