---
title: "RNA_pre-analysis"
output: html_document
date: "2024-01-04"
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
```
Load the libraries
```{r}
library(dplyr)
library(broom)
library(knitr)
library(coin)
library(data.table)
library(ggpubr)
library(rstatix)
# library(ggplot2)
# library(paletteer)
# library(PairedData)
library(tidyverse)
``` 

Load other options
```{r}
# options(scipen = 1, digits = 20)
getOption("max.print")
```


Load the RNA metrics dataset and remove the useless columns. 

The data shows the samples as rows and descriptive characteristics, the Tissue Source Site (TSS) and the Histology grouping as columns.

```{r}



first <- fread("Data/RNA_Data/Full_RNA_metrics10.csv")

used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]


``` 




QUESTION 1 


Visualise the distribution of the set of interest

```{r}
ggplot(used_first, aes(x = Mean_set)) +
  geom_histogram(aes(y = after_stat(density)),
                 colour = 1,
                 fill = "white",
                 bins = 50) +
  geom_density(lwd = 1,
               colour = 1) +
  labs(y = "Density", x = "Log2 Expression",
       title = "Distribution of the Set-of-Interest Log2 Expression Across Samples") +
  theme(
    axis.title = element_text(size = 13, color = "black", face = "bold"),
    axis.text = element_text(color = "black", size = 10),
    panel.background = element_rect(fill = "#EDEDED"),
    plot.title = element_text(hjust = 0.6, size = 15),
    panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
    panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
    panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
    panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
    panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
    plot.title.position = "plot"
  )
```




Create Violin plot of the distribution

```{r}
ggplot(used_first, aes(y = Mean_set, x ="")) +
  geom_violin(trim = FALSE)+
  geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
  labs(x = "Unique SoI / Control Pairings ", y = "Î” Log2 Expression",
       title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
  theme(
    legend.position = "none",
    axis.title = element_text(size = 13, color = "black", face = "bold"),
    axis.text = element_text(color = "black", size = 10),
    axis.text.x = element_blank(),
    panel.background = element_rect(fill = "#EDEDED"),
    legend.text = element_blank(),
    plot.title = element_text(hjust = 0.6, size = 15),
    panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
    panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
    plot.title.position = "plot"
  )

```

B) Add QQplot of the difference between the mean CNV per set

``` {r}
ggplot(data, aes(sample= Mean_diff)) +
  stat_qq() + 
  stat_qq_line(color= "red") +
  labs(title = "Normal QQ Plot for Analysis of the Average Set-of-Interest to \n Control Set Differential Mean Expression in Cancer Samples",
       y = "Sample Quantiles",
       x = "Theoretical Quantiles") +
  theme(
    axis.text.x = element_text(size= 8),
    axis.title.x = element_text(size= 13),
    axis.title.y = element_text(size= 13),
    legend.title =element_text(hjust = 0.5,
                               size = 11),
    plot.title = element_text(hjust = 0.5,
                              size = 14),
    panel.grid.major = element_line(color = "black",
                                    linewidth = 0.5,
                                    linetype = 1),
    panel.grid.minor = element_line(color = "black",
                                    linewidth = 0.2,
                                    linetype = 1),
    panel.background = element_rect(fill = "#EDEDED"),
    panel.border = element_rect(fill = "transparent",
                                color = 1,
                                linewidth = 2)
  ) 
```



