)
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff4")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff4")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff40")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff30")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
# options(scipen = 1, digits = 20)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 3000)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412
# Loop over the datasets
for (i in 2:num_datasets) {
file_name <- paste("Data/RNA_Data/Full_RNA_metrics", i, ".csv", sep = "")
# Read the CSV file into a data.table
current_dataset <- fread(file_name, nrows = 3000)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff30")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
paired_tests_list <- list()
for (i in 1:num_datasets) {
ctrl <- paste("Mean_cntrl", i, sep ="")
wlcx_paired_res = wilcox.test(used_first$Mean_set, used_first[,get(ctrl)], paired = TRUE)
wlcx_paired_res_pval <- wlcx_paired_res$p.value
formatted_pval <- sprintf("%.10f", wlcx_paired_res_pval)
# print(wlcx_paired_res)
pair <- paste("Pair", i, sep ="_")
pair_frame = data.frame(Pairing = pair, Pvalue = as.numeric(formatted_pval))
paired_tests_list[[i]] <- pair_frame
}
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
# options(scipen = 1, digits = 20)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 3000)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412
# Loop over the datasets
for (i in 2:num_datasets) {
file_name <- paste("Data/RNA_Data/Full_RNA_metrics", i, ".csv", sep = "")
# Read the CSV file into a data.table
current_dataset <- fread(file_name, nrows = 3000)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff30")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
paired_tests_list <- list()
for (i in 1:num_datasets) {
ctrl <- paste("Mean_cntrl", i, sep ="")
wlcx_paired_res = wilcox.test(used_first$Mean_set, used_first[,get(ctrl)], paired = TRUE)
wlcx_paired_res_pval <- wlcx_paired_res$p.value
formatted_pval <- sprintf("%.10f", wlcx_paired_res_pval)
# print(wlcx_paired_res)
pair <- paste("Pair", i, sep ="_")
pair_frame = data.frame(Pairing = pair, Pvalue = as.numeric(formatted_pval))
paired_tests_list[[i]] <- pair_frame
}
View(used_first)
full_paired = do.call(rbind, paired_tests_list)
full_paired$Corrected_Pval <- full_paired$Pvalue * num_datasets
controls <- c("Mean_set")
for (i in sample(1:num_datasets, 3)) {
controls <- c(controls, paste("Mean_cntrl", i, sep =""))
}
long_data <- used_first %>%
dplyr::select(all_of(controls)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(long_data, aes( y = Value, x = Variable)) +
geom_boxplot(outlier.colour = 2) +
stat_boxplot(geom = "errorbar") +
theme_minimal() +
labs(title = "Distribution of the Mean Copy Number in the Set-of-Interest vs the Control-Set",
y = "Log2 Expression") +
# scale_x_discrete(label = c("Control Set", "Set of Interest")) +
# scale_fill_hue(labels = c("Control Set", "Set of Interest"))+
theme(
legend.position = "None",
axis.title.y = element_text(size= 13),
plot.subtitle = element_text(hjust= 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(size = 11),
plot.title = element_text(hjust = 0.5,
size = 14),
panel.background = element_rect(fill = "#EDEDED"),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 2),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 2))
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project/Scripts")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(ggrepel)
data <- fread("../../../Data/CNV_Data/Full_CNV_metrics1.csv")
data[, ':=' ('Mean_diff' = Mean_set - Mean_cntrl, 'Median_diff' = Median_set - Median_cntrl)]
ggplot(data, aes(x = Mean_set)) +
geom_histogram(aes(y = after_stat(density)),
colour = 1,
fill = "white",
bins = 50) +
geom_density(lwd = 1, colour = 1) +
labs(y = "Density", x = "Copy Number",
title = "Distribution of the Set-of-Interest to Control-Set \n Copy Number Differential Across Samples") +
theme(
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
panel.background = element_rect(fill = "#EDEDED"),
plot.title = element_text(hjust = 0.5, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
ggplot(data, aes(sample= Mean_diff)) +
stat_qq() +
stat_qq_line(color= "red") +
labs(title = "Normal QQ Plot for Analysis of the \n Average Copy Number Differential in Cancer Samples",
y = "Sample Quantiles",
x = "Theoretical Quantiles") +
theme(
axis.text.x = element_text(size= 8),
axis.title.x = element_text(size= 13),
axis.title.y = element_text(size= 13),
legend.title =element_text(hjust = 0.5,
size = 11),
plot.title = element_text(hjust = 0.5,
size = 14),
panel.grid.major = element_line(color = "black",
linewidth = 0.5,
linetype = 1),
panel.grid.minor = element_line(color = "black",
linewidth = 0.2,
linetype = 1),
panel.background = element_rect(fill = "#EDEDED"),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 2)
)
# Bxplt_CNV_Distr <-
ggplot(data, aes( y = Mean_diff, x = "")) +
geom_boxplot(fill = "white",
outlier.colour = 2) +
stat_boxplot(geom = "errorbar") +
theme_minimal() +
labs(title = "Set-of-Interest to Control-Set \n Copy Number Differential in Cancer Samples Boxplot Analysis",
y = "Δ Copy Number") +
theme(
axis.text.x = element_text(angle= 90,
size= 8),
axis.title.y = element_text(size= 13),
axis.title.x = element_blank(),
plot.title = element_text(hjust = 0.5,
size = 14),
panel.background = element_rect(fill = "#EDEDED"),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 2),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 2))
wlcx_paired_res = wilcox.test(data$Mean_set, data$Mean_cntrl, paired = TRUE)
wlcx_paired_res_pval <- wlcx_paired_res$p.value
reshaped <- gather(data[,c("Mean_set","Mean_cntrl")], key = "Variable", value = "Value")
ggplot(reshaped, aes( y = Value, x = Variable, fill = Variable)) +
geom_boxplot(outlier.colour = 2) +
stat_boxplot(geom = "errorbar") +
theme_minimal() +
labs(title = "Distribution of the Mean Copy Number in \n the Set-of-Interest vs the Control-Set",
y = "CNV") +
scale_x_discrete(label = c("Control-Set", "Set-of-Interest")) +
scale_fill_hue(labels = c("Control-Set", "Set-of-Interest"))+
theme(
legend.position = "None",
axis.title.y = element_text(size= 13),
plot.subtitle = element_text(hjust= 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(size = 11),
plot.title = element_text(hjust = 0.5,
size = 14),
panel.background = element_rect(fill = "#EDEDED"),
panel.grid.major.y = element_line(color = "black", size = 0.25, linetype = 2),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 2)) +
geom_text(aes(x = 1.5,
y = max(Value) - 0.02*max(Value),
label = paste(c("P-value =", wlcx_paired_res_pval), collapse = " ")),
stat = "unique")
order_data <- setDF(data) %>%
arrange( Median_diff) %>%
mutate(Sample = factor(Sample, levels = unique(Sample)))
ggplot(order_data, aes(x = Sample, y = Median_diff, fill = TSS_Abbrvs)) +
geom_col() +
theme_minimal() +
ylim(c(-0.5, 0.5)) +
labs(y = "Δ Copy Number",
x = "Samples",
title = "Set-of-Interest to Control-Set Copy Number Differential by Sample ")+
theme(
axis.text.x = element_blank(),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
axis.title.x = element_text(size = 14),
legend.position = "right",
legend.text = element_text(size= 8),
legend.title =element_text(hjust = 0.5,
size = 13),
plot.title = element_text(hjust = 0.2,
size = 15),
plot.title.position = "plot",
panel.background = element_rect(fill = "#EDEDED"),
panel.grid.major.y = element_line(color = "black", size = 0.5, linetype = 2),
panel.grid.minor.y = element_line(color = "black", size = 0.25, linetype = 2),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(size = 0.35, linetype = "solid",
colour = "black"),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 1)) +
guides(fill = guide_legend(ncol = 1,
title = "Source Tissue Type",
title.position = "top"))
#
controls <- c("Mean_set")
for (i in sample(1:num_datasets, 3)) {
controls <- c(controls, paste("Mean_cntrl", i, sep =""))
}
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
# options(scipen = 1, digits = 20)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 3000)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412
# Loop over the datasets
for (i in 2:num_datasets) {
file_name <- paste("Data/RNA_Data/Full_RNA_metrics", i, ".csv", sep = "")
# Read the CSV file into a data.table
current_dataset <- fread(file_name, nrows = 3000)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
graph_long_data <- used_first %>%
dplyr::select(starts_with("Mean_diff30")) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
# Loop over each of the control datasets in the folder
# For each control-set perform a Two-Sample wilcoxon Signed-Rank test
# save the pvalue for each test in a dataframe
paired_tests_list <- list()
for (i in 1:num_datasets) {
ctrl <- paste("Mean_cntrl", i, sep ="")
wlcx_paired_res = wilcox.test(used_first$Mean_set, used_first[,get(ctrl)], paired = TRUE)
wlcx_paired_res_pval <- wlcx_paired_res$p.value
formatted_pval <- sprintf("%.10f", wlcx_paired_res_pval)
pair <- paste("Pair", i, sep ="_")
pair_frame = data.frame(Pairing = pair, Pvalue = as.numeric(formatted_pval))
paired_tests_list[[i]] <- pair_frame
}
# Correct the P-value due to multiple testing by using the Bonferoni method (more stringent than BH)
full_paired = do.call(rbind, paired_tests_list)
full_paired$Corrected_Pval <- full_paired$Pvalue * num_datasets
# Loop over each of the control datasets in the folder
# For each control-set perform a Two-Sample wilcoxon Signed-Rank test
# save the pvalue for each test in a dataframe
paired_tests_list <- list()
for (i in 1:num_datasets) {
ctrl <- paste("Mean_cntrl", i, sep ="")
wlcx_paired_res = wilcox.test(used_first$Mean_set, used_first[,get(ctrl)], paired = TRUE)
wlcx_paired_res_pval <- wlcx_paired_res$p.value
formatted_pval <- sprintf("%.10f", wlcx_paired_res_pval)
pair <- paste("Pair", i, sep ="_")
pair_frame = data.frame(Pairing = pair, Pvalue = as.numeric(formatted_pval))
paired_tests_list[[i]] <- pair_frame
}
# Correct the P-value due to multiple testing by using the Bonferoni method (more stringent than BH)
full_paired = do.call(rbind, paired_tests_list)
full_paired$Corrected_Pval <- full_paired$Pvalue * num_datasets
#
controls <- c("Mean_set")
for (i in sample(1:num_datasets, 3)) {
controls <- c(controls, paste("Mean_cntrl", i, sep =""))
}
long_data <- used_first %>%
dplyr::select(all_of(controls)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(long_data, aes( y = Value, x = Variable)) +
geom_boxplot(outlier.colour = 2) +
stat_boxplot(geom = "errorbar") +
theme_minimal() +
labs(title = "Distribution of the Mean Copy Number in the Set-of-Interest vs the Control-Set",
y = "Log2 Expression") +
# scale_x_discrete(label = c("Control Set", "Set of Interest")) +
# scale_fill_hue(labels = c("Control Set", "Set of Interest"))+
theme(
legend.position = "None",
axis.title.y = element_text(size= 13),
plot.subtitle = element_text(hjust= 0.5),
axis.title.x = element_blank(),
axis.text.x = element_text(size = 11),
plot.title = element_text(hjust = 0.5,
size = 14),
panel.background = element_rect(fill = "#EDEDED"),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 2),
panel.border = element_rect(fill = "transparent",
color = 1,
linewidth = 2))
View(order_data)
