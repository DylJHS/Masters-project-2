ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
pointColor = "purple",
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
shadeFill = "skyblue"
drawConnectors = TRUE,
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
shadeFill = "skyblue",
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
shadeFill = "skyblue",
shadeSize = 1,
shadeBins = 5,
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
shadeAlpha = 1/2,
shadeFill = "skyblue",
shadeSize = 1,
shadeBins = 5,
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "soi",
shadeAlpha = 1/2,
shadeFill = "skyblue",
shadeSize = 4,
shadeBins = 5,
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = "Set",
shadeAlpha = 1/2,
shadeFill = "skyblue",
shadeSize = 4,
shadeBins = 5,
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
shade = usable_tissues$Set == "soi",
shadeAlpha = 1/2,
shadeFill = "skyblue",
shadeSize = 4,
shadeBins = 5,
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 3, 1)),
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
Full_Volcano <- EnhancedVolcano(summary_pivot,
lab = summary_pivot$set,
x = "mean_log2fc",
y = "p",
xlim = c(-0.25,0.25),
selectLab = c('soi'),
pCutoff = 0.01,
FCcutoff = 0.05)
Full_Volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-1,1),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-1,1),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-1,2),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
sum(unique(all_combos$tissue_type))
count(unique(all_combos$tissue_type))
n(unique(all_combos$tissue_type))
unique(all_combos$tissue_type)
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-2,2),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-2,3),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-,3),
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-3,3),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(min(all_tissue_summary$avg_log2fc),max(all_tissue_summary$avg_log2fc)),
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
View(all_tissue_summary)
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(min(all_tissue_summary$avg_log2fc),max(all_tissue_summary$avg_log2fc)),
drawConnectors = TRUE,
widthConnectors = 0.2,
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(min(all_tissue_summary$avg_log2fc),max(all_tissue_summary$avg_log2fc)),
drawConnectors = TRUE,
widthConnectors = 0.5,
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano <- EnhancedVolcano(all_tissue_summary,
lab = all_tissue_summary$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(min(all_tissue_summary$avg_log2fc),max(all_tissue_summary$avg_log2fc)),
drawConnectors = TRUE,
widthConnectors = 0.2,
pCutoff = 0.01,
FCcutoff = 0.1)
all_tissue_volcano
all_tissue_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 6, 1)),
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
usable_tissues <- all_tissue_summary[all_tissue_summary$Tissue %in%
(all_combos %>%
dplyr::count(tissue_type) %>%
filter(n > 19) %>%
pull("tissue_type")),]
usable_volcano_facet <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.01,
FCcutoff = 0.1) +
facet_wrap(~Tissue, ncol = 3, scales = "free")
usable_volcano <- EnhancedVolcano(usable_tissues,
lab = usable_tissues$Set,
x = "avg_log2fc",
y = "p_val",
selectLab = c('soi'),
pointSize = c(ifelse(usable_tissues$Set == "soi", 4, 1)),
drawConnectors = TRUE,
widthConnectors = 0.2,
xlim = c(-0.95,0.95),
ylim = c(0,10),
pCutoff = 0.05,
FCcutoff = 0.1)
usable_volcano
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(knitr)
library(tidyverse)
transformed_data <- read.csv("Data/RNA_Data/TCGA_Norm/tcga_gene_expected_count.csv")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(knitr)
library(tidyverse)
transformed_data <- read.csv("Data/RNA_Data/TCGA_Norm/tcga_gene_expected_count.csv")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(knitr)
library(tidyverse)
transformed_data <- read.csv("Data/RNA_Data/TCGA_Norm/tcga_gene_expected_count.csv")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
transformed_data <- read.csv("Data/RNA_Data/TCGA_Norm/tcga_gene_expected_count.csv")
View(transformed_data)
return((2^y)-1)
return((2^x)-1)
untransform <- function(x) {
return((2^x)-1)
}
untransform <- function(x) {
return((2^x)-1)
}
count_data <- transformed_data %>% apply(transformed_data[,-1],2, untransform)
untransform <- function(x) {
return((2^x)-1)
}
count_data <- transformed_data %>% apply(transformed_data[,-1], untransform)
transformed_data <- transformed_data[,:5]
transformed_data <- transformed_data[,0:5]
transformed_data <- read.csv("Data/RNA_Data/TCGA_Norm/tcga_gene_expected_count.csv")
View(untransform)
View(transformed_data)
sample_data <- transformed_data[,0:5]
View(sample_data)
sample_data <- transformed_data[,0:5]
sample_data <- transformed_data[,0:5]
untransform <- function(x) {
return((2^x)-1)
}
count_data <- sample_data %>% apply(sample_data[,-1], untransform)
