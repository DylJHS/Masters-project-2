cat('\n',i,"th iteration duration: ", end_time - start_time, "seconds")
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 30
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
end_time <- Sys.time()
cat('\n',i,"th iteration duration: ", end_time - start_time, "seconds")
View(full_results)
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 50
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% summarise(count = n()) %>% kable()
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 3
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% summarise(count = n()) %>% kable()
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 3
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% summarise(count = n())
View(full_results)
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 3
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value)
end_time <- Sys.time()
cat('\n',i,"th iteration duration: ", end_time - start_time, "seconds")
View(Contrast_agg_count_table)
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 3
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% dplyr::summarise(count = n())
end_time <- Sys.time()
cat('\n',i,"th iteration duration: ", end_time - start_time, "seconds")
View(Contrast_agg_count_table)
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 547
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
it_time <- Sys.time()
cat('\n',i,"th iteration duration: ", it_time - start_time, "seconds")
}
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(plyr)
library(coin)
library(knitr)
library(rstatix)
library(jmuOutlier)
library(tidyverse)
library(ggpubr)
getOption("max.print")
set.seed(123)
NORMAL_SOI <- read.csv("Data/RNA_Data/TCGA_TPM/TCGA_Normal_mRNA_TPM_SOI.csv")
TUMOUR_SOI <- read.csv("Data/RNA_Data/TCGA_TPM/TCGA_mRNA_TPM_SOI.csv")
Meta_data <- read.csv("Data/Other/TCGA_meta/tissueSourceSite.tsv", sep = "\t")
calculate_summary <- function(input_dataframe) {
df_name <- deparse(substitute(input_dataframe))
# Calculate column means
means <- colMeans(input_dataframe[, -c(1, 2)], na.rm = TRUE)
# Create a new dataframe to store the summary
Summary_Dataframe <- data.frame( Mean = means)
prefix <- sub("^(.*?)_.*$", "\\1", df_name)
colnames(Summary_Dataframe)[colnames(Summary_Dataframe) == "Mean"] <- paste0(prefix, "_geom_mean")
return(Summary_Dataframe)
}
SOI_COMBO <- merge(calculate_summary(NORMAL_SOI) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(TUMOUR_SOI)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
kable(head(SOI_COMBO, n = 15))
data <- SOI_COMBO %>%
select(-c("id.x", "id.y"))%>%
gather(key = "Condition", value = "Geom_mean", NORMAL_geom_mean, TUMOUR_geom_mean)
data <- SOI_COMBO %>%
gather(key = "Condition", value = "Geom_mean", NORMAL_geom_mean, TUMOUR_geom_mean)
kable(head(data, n = 15))
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(plyr)
library(coin)
library(knitr)
library(rstatix)
library(jmuOutlier)
library(tidyverse)
library(ggpubr)
getOption("max.print")
set.seed(123)
NORMAL_SOI <- read.csv("Data/RNA_Data/TCGA_TPM/TCGA_Normal_mRNA_TPM_SOI.csv")
TUMOUR_SOI <- read.csv("Data/RNA_Data/TCGA_TPM/TCGA_mRNA_TPM_SOI.csv")
Meta_data <- read.csv("Data/Other/TCGA_meta/tissueSourceSite.tsv", sep = "\t")
calculate_summary <- function(input_dataframe) {
df_name <- deparse(substitute(input_dataframe))
# Calculate column means
means <- colMeans(input_dataframe[, -c(1, 2)], na.rm = TRUE)
# Create a new dataframe to store the summary
Summary_Dataframe <- data.frame( Mean = means)
prefix <- sub("^(.*?)_.*$", "\\1", df_name)
colnames(Summary_Dataframe)[colnames(Summary_Dataframe) == "Mean"] <- paste0(prefix, "_geom_mean")
return(Summary_Dataframe)
}
SOI_COMBO <- merge(calculate_summary(NORMAL_SOI) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(TUMOUR_SOI)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
kable(head(SOI_COMBO, n = 15))
data <- SOI_COMBO %>%
gather(key = "Condition", value = "Geom_mean", NORMAL_geom_mean, TUMOUR_geom_mean)
kable(head(data, n = 15))
data %>%
group_by(Condition) %>%
get_summary_stats(Geom_mean, type = "median_iqr") %>% kable()
bxp <- ggpaired(data, x = "Condition", y = "Geom_mean",
order = c("NORMAL_geom_mean", "TUMOUR_geom_mean"),
ylab = "Geom_mean", xlab = "Condition")
bxp
stat.test <- data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
stat.test
start_time <- Sys.time()
results <- list()
# Loop over the control datasets
num_datasets <- 547
for (i in 1:num_datasets) {
can_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Cancer_CTRL_Sets/TCGA_TPM_RNA_Control_df", i, ".csv", sep = "")
can_ctrl_set <- read.csv(can_ctrl_file)
nrm_ctrl_file <- paste("Data/RNA_Data/TCGA_TPM/TCGA_Normal_CTRL_Sets/TCGA_Normal_mRNA_TPM_CTRL_Set", i, ".csv", sep = "")
nrm_ctrl_set <- read.csv(nrm_ctrl_file)
new_combo <- merge(calculate_summary(can_ctrl_set) %>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
calculate_summary(nrm_ctrl_set)%>%
rownames_to_column(var = "id") %>%
rowwise() %>%
mutate( Participant = strsplit(id,"\\.")[[1]][3]) %>%
select(-c("id")),
by = "Participant",
all = FALSE)
new_data <- new_combo %>%
gather(key = "Condition", value = "Geom_mean", nrm_geom_mean, can_geom_mean)
new_stat.test <- new_data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
results[[i]] <- new_stat.test
it_time <- Sys.time()
cat('\n',i,"th iteration duration: ", it_time - start_time, "seconds")
}
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"), Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% dplyr::summarise(count = n())
View(Contrast_agg_count_table)
View(full_results)
kable(Contrast_agg_count_table)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Perc <- Contrast_agg_count_table$count / sumContrast_agg_count_table$count()
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Perc <- Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count)
Contrast_agg_count_table$Perc <- Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count)
kable(Contrast_agg_count_table)
View(Contrast_agg_count_table)
View(full_results)
View(SOI_COMBO)
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO$DIF, aes(y = y)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO, aes(y = SOI_COMBO$DIF)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO, aes(x = "", y = SOI_COMBO$DIF)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO, aes(x = "", y = SOI_COMBO$DIF)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
describe(SOI_COMBO)
install.packages("psych")
library(dplyr)
library(plyr)
library(coin)
library(knitr)
library(rstatix)
library(tidyverse)
library(psych)
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO, aes(x = "", y = SOI_COMBO$DIF)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
describe(SOI_COMBO)
SOI_COMBO$DIF <- SOI_COMBO$TUMOUR_geom_mean - SOI_COMBO$NORMAL_geom_mean
ggplot(SOI_COMBO, aes(x = "", y = SOI_COMBO$DIF)) +
stat_boxplot(geom = "errorbar",
width = 0.15) +
geom_boxplot()
describe(SOI_COMBO) %>% kable()
data %>%
group_by(Condition) %>%
get_summary_stats(Geom_mean, type = "median_iqr") %>% kable()
Contrast_agg_count_table$Freq <- Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count) *100
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count) *100, 3)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count) *100, 2)
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count) *100, 2)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count), 2)
kable(Contrast_agg_count_table)
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count), 3)
kable(Contrast_agg_count_table)
Contrast_agg_count_table <- full_results %>% group_by(Significant_value) %>% dplyr::summarise(count = n())
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count), 3)
kable(Contrast_agg_count_table)
View(results)
stat.test <- data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
kable(stat.test)
observed_val <- stat.test$p
stat.test <- data  %>%
wilcox_test(Geom_mean ~ Condition, paired = TRUE, alternative = "less") %>%
add_significance()
stat.test
observed_val <- stat.test$p
observed_val
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results, n = 15))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results, n = 15))
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
knitr::kable(mtcars, format = "html") %>%
as.character() %>%
HTML(width = "100%")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(knitr)
knitr::kable(mtcars, format = "html") %>%
as.character() %>%
htmltools::HTML(width = "100%")
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
knitr::kable(mtcars, format = "html") %>%
as.character() %>%
htmltools::HTML(width = "100%")
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results, n = 15))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p .= observed_val, "TRUE" , "FALSE"))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p >= observed_val, "TRUE" , "FALSE"))
kable(head(full_results))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"))
kable(head(full_results))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
ex_Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"),
sim_Level = ifelse(p.signif = "****", "TRUE" , "FALSE"))
full_results <- do.call(rbind, results)
full_results <- mutate(full_results, Adjusted_p = p.adjust(full_results$p, method = "BH"),
Significant_value = ifelse(Adjusted_p < 0.05, "TRUE" , "FALSE"),
ex_Level = ifelse(Adjusted_p <= observed_val, "TRUE" , "FALSE"),
sim_Level = ifelse(p.signif == "****", "TRUE" , "FALSE"))
kable(head(full_results))
Contrast_agg_count_table <- full_results %>% group_by(sim_Level) %>% dplyr::summarise(count = n())
Contrast_agg_count_table$Freq <- round(Contrast_agg_count_table$count / sum(Contrast_agg_count_table$count), 3)
kable(Contrast_agg_count_table)
