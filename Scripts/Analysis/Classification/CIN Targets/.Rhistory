for (i in 2:nrow(combined_peri)) {
combined_peri$combined_group[i] <- ifelse(
combined_peri$combined[i - 1],
combined_peri$combined_group[i - 1],
combined_peri$combined_group[i - 1] + 1
)
}
combined_per <- combined_peri %>%
group_by(seqnames, combined_group) %>%
summarise(start = first(start),
end = last(end),
width = sum(width))
combined_peri <- peri_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(combined_peri)) {
combined_peri$combined_group[i] <- ifelse(
combined_peri$combined[i - 1],
combined_peri$combined_group[i - 1],
combined_peri$combined_group[i - 1] + 1
)
}
combined_per <- combined_peri %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width))
alt_com_peri <- combined_peri %>%
group_by(seqnames) %>%
arrange(start) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width))
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(rtracklayer)
library(tidyverse)
ori_segmnt_cnv <- read_tsv("Data/CIN_Features/CNV_Data/Chrom_seg_CNV.txt")
maps <- import("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project/Data/Other/censat.bb")
maps <- data.frame(maps)
# all_segs <- data.frame(
#   seqnames = as.factor(maps$seqnames),
#   start = as.numeric(maps$start),
#   end = as.numeric(maps$end),
#   width = as.numeric(maps$width),
#   name = as.character(maps$name))
peri_segs <- all_segs %>%
filter(grepl("hsat", name)) %>%
select(c("seqnames","start", "end", "width")) %>%
arrange(seqnames, start)
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width")) %>%
arrange(seqnames, start)
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(rtracklayer)
library(tidyverse)
ori_segmnt_cnv <- read_tsv("Data/CIN_Features/CNV_Data/Chrom_seg_CNV.txt")
maps <- import("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project/Data/Other/censat.bb")
all_segs <- data.frame(maps)
# all_segs <- data.frame(
#   seqnames = as.factor(maps$seqnames),
#   start = as.numeric(maps$start),
#   end = as.numeric(maps$end),
#   width = as.numeric(maps$width),
#   name = as.character(maps$name))
peri_segs <- all_segs %>%
filter(grepl("hsat", name)) %>%
select(c("seqnames","start", "end", "width")) %>%
arrange(seqnames, start)
combined_peri <- peri_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(combined_peri)) {
combined_peri$combined_group[i] <- ifelse(
combined_peri$combined[i - 1],
combined_peri$combined_group[i - 1],
combined_peri$combined_group[i - 1] + 1
)
}
combined_peri <- combined_peri %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width))
alt_com_peri <- combined_peri %>%
group_by(seqnames) %>%
arrange(start) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width))
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width")) %>%
arrange(seqnames, start)
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-combined_group)
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-combined_group)
View(comb_gbh)
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-combined_group)
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group", "name"))
# Get all regions annotated as HOR alpha satellites, transition satellites (ct) or general centromeric satellites (censat)
HOR_segs <- all_segs %>%
filter((grepl("hor", name)) | (grepl("ct", name))|(grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the regions into a single range if they are a adjacent to one another and only select the ranges that contain an active HOR (true centromeric) region
comb_HOR <- HOR_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_HOR)) {
comb_HOR$combined_group[i] <- ifelse(
comb_HOR$combined[i - 1],
comb_HOR$combined_group[i - 1],
comb_HOR$combined_group[i - 1] + 1
)
}
comb_HOR <- comb_HOR %>%
group_by(seqnames, combined_group) %>%
summarise(start = first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter((grepl("hor", name))&(grepl("L",name))) %>%
select(-c("combined_group", "name"))
# Get all regions annotated as HOR alpha satellites, transition satellites (ct) or general centromeric satellites (censat)
HOR_segs <- all_segs %>%
filter((grepl("hor", name)) | (grepl("ct", name))|(grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the regions into a single range if they are a adjacent to one another and only select the ranges that contain an active HOR (true centromeric) region
comb_HOR <- HOR_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_HOR)) {
comb_HOR$combined_group[i] <- ifelse(
comb_HOR$combined[i - 1],
comb_HOR$combined_group[i - 1],
comb_HOR$combined_group[i - 1] + 1
)
}
comb_HOR <- comb_HOR %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter((grepl("hor", name))&(grepl("L",name))) %>%
select(-c("combined_group", "name"))
# Create the data frame that will contain the final pericentromeric regions
final_peri <- data.frame(
Chromosome = character(),
Start = numeric(),
End = numeric(),
Width = numeric()
)
# Loop over the different chromosomes other than 3 and 4
chroms <- unique(as.character(comb_gbh$seqnames))[!unique(comb_gbh$seqnames) %in% c("chr3", "chr4")]
for (chr in chroms) {
gbh_ranges <- comb_gbh %>%
filter(seqnames == chr)
# get the acctive HOR region for that chromosome
hor_start <- comb_HOR %>%
filter(seqnames == chr) %>%
pull(start) %>%
`[`(1)
# combine gbh ranges that are either all upstream or downstream of the hor region
gbh_ranges <- gbh_ranges %>%
mutate(
BfAf = ifelse(end <= hor_start, 0, 1)
) %>%
group_by(seqnames, BfAf) %>%
summarise(
start = first(start),
end = last(end),
width = sum(width)
) %>%
select(-BfAf)
# add the new chromosome-specific pericentromeric regions to the final dataframe
final_peri <- rbind(final_peri,gbh_ranges)
}
# Create the data frame that will contain the final pericentromeric regions
final_peri <- data.frame(
Chromosome = character(),
Start = numeric(),
End = numeric(),
Width = numeric()
)
# Loop over the different chromosomes other than 3 and 4
chroms <- unique(as.character(comb_gbh$seqnames))[!unique(comb_gbh$seqnames) %in% c("chr3", "chr4")]
for (chr in chroms) {
gbh_ranges <- comb_gbh %>%
filter(seqnames == chr)
# get the acctive HOR region for that chromosome
hor_start <- comb_HOR %>%
filter(seqnames == chr) %>%
pull(start) %>%
`[`(1)
# combine gbh ranges that are either all upstream or downstream of the hor region
gbh_ranges <- gbh_ranges %>%
mutate(
BfAf = ifelse(end <= hor_start, 0, 1)
) %>%
group_by(seqnames, BfAf) %>%
summarise(
start = dplyr::first(start),
end = last(end),
width = sum(width)
) %>%
select(-BfAf)
# add the new chromosome-specific pericentromeric regions to the final dataframe
final_peri <- rbind(final_peri,gbh_ranges)
}
# c34<- comb_gbh %>%
#   filter((seqnames == "chr3") | (seqnames == "chr4")) %>%
#   rename(seqnames = "Chromosome",
#          start = "Start",
#          end = "End",
#          width = "Width")
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
View(combined_peri)
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))| (grepl("ct", name))| (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter(grepl("hsat", name))%>%
select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter(grepl("hsat", name))%>%
select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))| (grepl("ct", name))| (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
View(gbh_segs)
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter(grepl("hsat", name))%>%
select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
gbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# group by chromosome and identify adjacent ranges
comb_gbh <- gbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
for (i in 2:nrow(comb_gbh)) {
comb_gbh$combined_group[i] <- ifelse(
comb_gbh$combined[i - 1],
comb_gbh$combined_group[i - 1],
comb_gbh$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
comb_gbh <- comb_gbh %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter(grepl("hsat", name))%>%
select(-c("combined_group"))
