#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cbgh_fltrd <- data.frame()
subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name))) %>%
filter(first_hsat == 1) %>%
# Optionally remove the helper column if you don't need it in the final output
select(-first_hsat) %>%
# Ungroup to avoid issues in subsequent operations
ungroup()
# for (i in 2:nrow(comb_cgbh)) {
#   comb_cgbh$combined_group[i] <- ifelse(
#     comb_cgbh$combined[i - 1],
#     comb_cgbh$combined_group[i - 1],
#     comb_cgbh$combined_group[i - 1] + 1
#   )
# }
#
#
#
# # combine the adjacent ranges
# adj_cgbh <- comb_cgbh %>%
#   group_by(seqnames, combined_group) %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cbgh_fltrd <- data.frame()
subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name)))))
# filter(first_hsat == 1) %>%
# # Optionally remove the helper column if you don't need it in the final output
# select(-first_hsat) %>%
# # Ungroup to avoid issues in subsequent operations
# ungroup()
# for (i in 2:nrow(comb_cgbh)) {
#   comb_cgbh$combined_group[i] <- ifelse(
#     comb_cgbh$combined[i - 1],
#     comb_cgbh$combined_group[i - 1],
#     comb_cgbh$combined_group[i - 1] + 1
#   )
# }
#
#
#
# # combine the adjacent ranges
# adj_cgbh <- comb_cgbh %>%
#   group_by(seqnames, combined_group) %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cbgh_fltrd <- data.frame()
subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
# for (i in 2:nrow(comb_cgbh)) {
#   comb_cgbh$combined_group[i] <- ifelse(
#     comb_cgbh$combined[i - 1],
#     comb_cgbh$combined_group[i - 1],
#     comb_cgbh$combined_group[i - 1] + 1
#   )
# }
#
#
#
# # combine the adjacent ranges
# adj_cgbh <- comb_cgbh %>%
#   group_by(seqnames, combined_group) %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
#
#
#
# # combine the adjacent ranges
# adj_cgbh <- comb_cgbh %>%
#   group_by(seqnames, combined_group) %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
View(cgbh_subset)
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
filter(grepl("hsat", name))%>%
select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
#          last_hsat = rev(cummax(rev(grepl("hsat", name)))))
# %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name)))))
# %>%
#   summarise(start = dplyr::first(start),
#             end = last(end),
#             width = sum(width),
#             name = paste(name, collapse = ", ")) %>%
#   filter(grepl("hsat", name))%>%
#   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
# Group by seqnames
group_by(seqnames) %>%
# Add a cumulative sum that increments for each match of "hsat" in name, starting from the first occurrence
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# combine the adjacent ranges
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", "))
# %>%
# #   filter(grepl("hsat", name))%>%
# #   select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the adjacent ranges
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
group_by(seqnames) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# Ensuring that the resulting combined regions start and end with HSat regions
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the adjacent ranges
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
group_by(seqnames) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# Ensuring that the resulting combined regions start and end with HSat regions
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
# Select the longest range from each chromosome
final_cgbh <- adj_cgbh %>%
group_by(seqnames) %>%
summarise(max(width))
View(final_cgbh)
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the adjacent ranges
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
group_by(seqnames) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# Ensuring that the resulting combined regions start and end with HSat regions
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
# Select the longest range from each chromosome
final_cgbh <- adj_cgbh %>%
group_by(seqnames) %>%
filter(width == max(width))
# from the T2T data select the ranges for the annotations of satellites that correspond to pericentromeric sats
cgbh_segs <- all_segs %>%
filter((grepl("hsat", name)) | (grepl("gsat", name)) | (grepl("bsat", name)) | (grepl("ct", name)) | (grepl("censat", name))) %>%
select(c("seqnames","start", "end", "width", "name")) %>%
arrange(seqnames, start)
# Combine the adjacent ranges
comb_cgbh <- cgbh_segs %>%
group_by(seqnames) %>%
arrange(start) %>%
mutate(end_next = lead(start),
combined = ifelse(end == end_next & !is.na(end_next), TRUE, FALSE),
combined_group = 0) %>%
select(-"end_next") %>%
arrange(seqnames, start )
cgbh_subset <- comb_cgbh %>%
group_by(seqnames) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
ungroup()
for (i in 2:nrow(cgbh_subset)) {
cgbh_subset$combined_group[i] <- ifelse(
cgbh_subset$combined[i - 1],
cgbh_subset$combined_group[i - 1],
cgbh_subset$combined_group[i - 1] + 1
)
}
# Ensuring that the resulting combined regions start and end with HSat regions
adj_cgbh <- cgbh_subset %>%
group_by(seqnames, combined_group) %>%
mutate(first_hsat = cummax(grepl("hsat", name)),
last_hsat = rev(cummax(rev(grepl("hsat", name))))) %>%
filter((first_hsat == 1) & (last_hsat == 1)) %>%
select(-c("first_hsat","last_hsat")) %>%
summarise(start = dplyr::first(start),
end = last(end),
width = sum(width),
name = paste(name, collapse = ", ")) %>%
select(-c("combined_group"))
# Select the longest range from each chromosome
final_cgbh <- adj_cgbh %>%
group_by(seqnames) %>%
filter((width == max(width)) | (width >= 1000000))
View(comb_cgbh)
