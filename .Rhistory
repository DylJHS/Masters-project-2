num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, get(new_name1), get(new_name2))]
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE)
}
View(used_first)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, get(new_name1), get(new_name2))]
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
setnames(used_first, old = c("Sample", new_name1, new_name2),
new = c("Sample", paste('Mean_cntrl', i, sep = ""), paste('Mean_diff', i, sep = "")))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, get(new_name1), get(new_name2))]
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
setnames(used_first, old = c( new_name1, new_name2),
new = c(paste('Mean_cntrl', i, sep = ""), paste('Mean_diff', i, sep = "")))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, get(new_name1), get(new_name2))]
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
print(used_first)
setnames(used_first, old = c( new_name1, new_name2),
new = c(paste('Mean_cntrl', i, sep = ""), paste('Mean_diff', i, sep = "")))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, get(new_name1), get(new_name2))]
print(selected_columns)
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
setnames(current_dataset, old = "Mean_cntrl", new = new_name1)
setnames(current_dataset, old = "Mean_diff", new = new_name2)
selected_columns <- current_dataset[, .(Sample, new_name1, get(new_name2))]
print(selected_columns)
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, .(Sample, new_name1, new_name2)]
# Perform an inner join with 'used_first' based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
View(used_first)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, .(Sample, new_name1, new_name2)]
print(selected_columns)
# Perform an inner join with 'used_first' based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 4  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
print(selected_columns)
# Perform an inner join with 'used_first' based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
View(used_first)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
View(used_first)
data_long <- used_first %>%
gather(key = "variable", value = "value", starts_with("Mean_diff"))
View(data_long)
View(data_long)
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
setwd("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
long_data <- pivot_longer(used_first, cols = starts_with("Mean_diff"), names_to = "Variable", values_to = "Value")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyr)
long_data <- pivot_longer(used_first, cols = starts_with("Mean_diff"), names_to = "Variable", values_to = "Value")
View(long_data)
View(used_first)
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyr)
setwd("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path, nrows = 5)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
View(used_first)
long_data <- pivot_longer(used_first, cols = starts_with("Mean_diff"), names_to = "Variable", values_to = "Value")
View(long_data)
long_data <- pivot_longer(used_first, cols = starts_with("Mean_d"), names_to = "Variable", values_to = "Value")
View(long_data)
ggplot(used_data, aes(x = Mean_diff)) +
geom_histogram(aes(y = ..density..),
colour = 1,
fill = "white",
bins = 35) +
geom_density(lwd = 1,
colour = 1) +
labs(y = "Density", x = "Î” Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Samples") +
theme(
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
panel.background = element_rect(fill = "#EDEDED"),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
long_data <- used_first %>% pivot_longer(cols = starts_with("Mean_d"), names_to = "Variable", values_to = "Value")
View(long_data)
long_data <- used_first %>% select(starts_with("Mean_diff"))
long_data <- used_first %>% select(starts_with("Mean_diff"))
long_data <- used_first %>% select(c(starts_with("Mean_diff")))
long_data <- used_first %>% select(`starts_with("Mean_diff")`)
long_data <- used_first %>% select(`starts_with("Mean_diff")`)
long_data <- used_first %>% select(starts_with("Mean_diff"))
long_data <- used_first %>% select(starts_with("Mean_diff"))
long_data <- used_first %>% select(starts_with("Mean_diff"))
long_data <- used_first %>% select(starts_with("Mean"))
long_data <- used_first %>% select(starts_with("Mean"))
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
install.packages("tidyverse")
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path, nrows = 5)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
setwd("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
long_data <- used_first %>% select(starts_with("Mean"))
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path, nrows = 5)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
View(used_first)
data <- read_csv("../../../Data/RNA_Data/Full_RNA_Sample_metrics.csv")
setwd("/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
data <- read_csv("../../../Data/RNA_Data/Full_RNA_Sample_metrics.csv")
data <- read_csv("../../../Data/RNA_Data/Full_RNA_Sample_metrics.csv", sep = ',')
data <- read_csv("../../../Data/RNA_Data/Full_RNA_Sample_metrics.csv")
data <- fread("../../../Data/RNA_Data/Full_RNA_Sample_metrics.csv")
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path, nrows = 5)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
long_data <- used_first %>% select(starts_with("Mean"))
long_data <- used_first %>% select(,starts_with("Mean"))
long_data <- used_first %>% select(starts_with("Mean"))
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
used_first <- first[,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412  # Change this to the actual number of datasets
# Specify the directory where your CSV files are located
data_directory <- "Data/RNA_Data/"
# Loop over the datasets
for (i in 2:num_datasets) {
# Construct the file path dynamically
file_name <- paste("Full_RNA_metrics", i, ".csv", sep = "")
file_path <- file.path(data_directory, file_name)
# Read the CSV file into a data.table
current_dataset <- fread(file_path, nrows = 5)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
first <- read_csv("Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
first <- read_csv(file = "Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
library(dplyr)
library(readr)
library(ggplot2)
library(ggpubr)
library(rstatix)
library(paletteer)
library(PairedData)
library(tidyverse)
first <- read_csv(file = "Data/RNA_Data/Full_RNA_metrics1.csv", nrows = 5)
install.packages("readr")
