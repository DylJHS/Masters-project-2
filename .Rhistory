colour = 1,
fill = "white",
bins = 50) +
geom_density(lwd = 1,
colour = 1) +
labs(y = "Density", x = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Samples") +
theme(
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
panel.background = element_rect(fill = "#EDEDED"),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
library(dplyr)
library(broom)
library(knitr)
library(coin)
library(data.table)
library(ggpubr)
library(rstatix)
# library(ggplot2)
# library(paletteer)
# library(PairedData)
library(tidyverse)
# options(scipen = 1, digits = 20)
getOption("max.print")
random_rows <- sample(1:11060, 500)
first <- fread("Data/RNA_Data/Full_RNA_metrics1.csv")
used_first <- first[random_rows,c("Sample", "Mean_set", "Mean_cntrl","TSS","Hist_group", "TSS_Abbrvs")]
setnames(used_first, old = "Mean_cntrl", new = "Mean_cntrl1")
used_first[, Mean_diff1 := (Mean_set - Mean_cntrl1)]
num_datasets <- 412
# Loop over the datasets
for (i in 2:num_datasets) {
file_name <- paste("Data/RNA_Data/Full_RNA_metrics", i, ".csv", sep = "")
# Read the CSV file into a data.table
current_dataset <- fread(file_name)
current_dataset[, Mean_diff := (Mean_set - Mean_cntrl)]
new_name1 = paste('Mean_cntrl', i, sep = "")
new_name2 = paste('Mean_diff', i, sep = "")
rename_map <- c("Mean_cntrl" = new_name1, "Mean_diff" = new_name2)
# Rename columns in 'current_dataset' using the named vector
setnames(current_dataset, old = names(rename_map), new = rename_map)
# Select columns with their original names from 'current_dataset' and rename them
selected_columns <- current_dataset[random_rows, c("Sample", new_name1, new_name2), with = FALSE]
# Perform a merge based on Sample ID
used_first <- merge(used_first, selected_columns, by = "Sample", all = FALSE, suffixes = c("", i))
}
ggplot(used_first, aes(x = Mean_set)) +
geom_histogram(aes(y = after_stat(density)),
colour = 1,
fill = "white",
bins = 50) +
geom_density(lwd = 1,
colour = 1) +
labs(y = "Density", x = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Samples") +
theme(
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
panel.background = element_rect(fill = "#EDEDED"),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.major.x = element_line(color = "black", linewidth = 0.25, linetype = 1),
panel.grid.minor.x = element_line(color = "black", linewidth = 0.1, linetype = 1),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 1),
plot.title.position = "plot"
)
violin_graph_long_data <- used_first %>%
dplyr::select(sample(starts_with("Mean_dif"), 7)) %>%
pivot_longer(cols = everything(),
names_to = "Variable",
values_to = "Value")
ggplot(violin_graph_long_data, aes(y = Value, x = Variable)) +
geom_violin(trim = FALSE)+
geom_boxplot(varwidth = T, alpha  = 0.25, outlier.colour = "red")+
labs(x = "Unique SoI / Control Pairings ", y = "Δ Log2 Expression",
title = "Distribution of the Set-of-Interest to Control Set \n Differential Log2 Expression Across Various Pairings") +
theme(
legend.position = "none",
axis.title = element_text(size = 13, color = "black", face = "bold"),
axis.text = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
panel.background = element_rect(fill = "#EDEDED"),
legend.text = element_blank(),
plot.title = element_text(hjust = 0.6, size = 15),
panel.border = element_rect(fill = "transparent", color = 1, linewidth = 1),
panel.grid.major.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_line(color = "black", linewidth = 0.1, linetype = 2),
plot.title.position = "plot"
)
Fried_test_data <- used_first %>%
gather(key = "Pairing", value = "Differential", starts_with("Mean_cntrl")) %>%
mutate(Sample = as.factor(Sample), Pairing = as.factor(Pairing)) %>%
select(Sample, Pairing, Differential)
friedman_result <- coin::friedman_test(Differential ~ Pairing | Sample.               , data = Fried_test_data)
knitr::opts_knit$set(root.dir = "/Users/Dyll/Documents/Education/VU_UVA/Internship/Epigenetics/Janssen_Group-UMCUtrecht/Main_Project")
n <- 7
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
first <- read.csv("Data/CNV_Data/CNV_Full.csv")
print(head(first), dim(first))
print()
dim(first)
# Pearson
cnv_cor_pear <- cor(cor_data, method = "pearson")
set.seed(123)
Sample_data <- first[,sample(1:10000, 300)]
print(head(Sample_data))
column_names <- colnames(Sample_data)[-1]
cor_data <- Sample_data[,column_names]
print(head(cor_data))
# Pearson
cnv_cor_pear <- cor(cor_data, method = "pearson")
Pears_dist_matrix <- apply(cnv_cor_pear, MARGIN = c(1, 2), FUN = function(x) {
result <- 1-x
return(result)})
# Euclidean
# trans_data <- t(cor_data)
# Eucl_dist_matrix <- as.matrix(dist(trans_data))
# print(Eucl_dist_matrix)
n <- 7
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
# Pearson
cnv_cor_pear <- cor(cor_data, method = "pearson")
Pears_dist_matrix <- apply(cnv_cor_pear, MARGIN = c(1, 2), FUN = function(x) {
result <- 1-x
return(result)})
# Euclidean
# trans_data <- t(cor_data)
# Eucl_dist_matrix <- as.matrix(dist(trans_data))
# print(Eucl_dist_matrix)
library(dplyr)
library(pheatmap)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(ComplexHeatmap)
library(circlize)
library(tiff)
library(cluster)
n <- 7
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
print(Pears_dist_plot)
# Euc_dist_plot <-Heatmap(Eucl_dist_matrix,
#          rect_gp = gpar(col = "black", lwd = 0.05),
#         col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
#         row_names_gp = gpar(fontsize = 2),
#         column_names_gp = gpar(fontsize = 2),
#         column_km = n,
#         column_km_repeats = 300
#         )
#
# print(Euc_dist_plot)
n <- 2
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
print(Pears_dist_plot)
# Euc_dist_plot <-Heatmap(Eucl_dist_matrix,
#          rect_gp = gpar(col = "black", lwd = 0.05),
#         col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
#         row_names_gp = gpar(fontsize = 2),
#         column_names_gp = gpar(fontsize = 2),
#         column_km = n,
#         column_km_repeats = 300
#         )
#
# print(Euc_dist_plot)
set.seed(123)
Sample_data <- first[,sample(1:10000, 800)]
print(head(Sample_data))
column_names <- colnames(Sample_data)[-1]
cor_data <- Sample_data[,column_names]
print(head(cor_data))
# Pearson
cnv_cor_pear <- cor(cor_data, method = "pearson")
Pears_dist_matrix <- apply(cnv_cor_pear, MARGIN = c(1, 2), FUN = function(x) {
result <- 1-x
return(result)})
# Euclidean
# trans_data <- t(cor_data)
# Eucl_dist_matrix <- as.matrix(dist(trans_data))
# print(Eucl_dist_matrix)
n <- 2
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
print(Pears_dist_plot)
# Euc_dist_plot <-Heatmap(Eucl_dist_matrix,
#          rect_gp = gpar(col = "black", lwd = 0.05),
#         col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
#         row_names_gp = gpar(fontsize = 2),
#         column_names_gp = gpar(fontsize = 2),
#         column_km = n,
#         column_km_repeats = 300
#         )
#
# print(Euc_dist_plot)
n <- 5
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
print(Pears_dist_plot)
# Euc_dist_plot <-Heatmap(Eucl_dist_matrix,
#          rect_gp = gpar(col = "black", lwd = 0.05),
#         col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
#         row_names_gp = gpar(fontsize = 2),
#         column_names_gp = gpar(fontsize = 2),
#         column_km = n,
#         column_km_repeats = 300
#         )
#
# print(Euc_dist_plot)
n <- 10
Pears_dist_plot <-Heatmap(Pears_dist_matrix,
rect_gp = gpar(col = "black", lwd = 0.05),
col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
row_names_gp = gpar(fontsize = 2),
column_names_gp = gpar(fontsize = 2),
column_km = n,
column_km_repeats = 300
)
print(Pears_dist_plot)
# Euc_dist_plot <-Heatmap(Eucl_dist_matrix,
#          rect_gp = gpar(col = "black", lwd = 0.05),
#         col = colorRamp2(c(0, 1, 2), c("#20c712", "white", "purple2")),
#         row_names_gp = gpar(fontsize = 2),
#         column_names_gp = gpar(fontsize = 2),
#         column_km = n,
#         column_km_repeats = 300
#         )
#
# print(Euc_dist_plot)
n <- 5
# Calculate silhouette scores for different values of k
silhouette_scores <- numeric(length = n - 1)  # Adjust the length
for (k in 2:n) {  # Start from k=2
kmeans_model <- kmeans(cor_data, centers = k)
sil_score <- silhouette(kmeans_model$cluster, dist(cor_data))
silhouette_scores[k-1] <- mean(sil_score[, 3])  # Assuming you want the mean silhouette width
}
