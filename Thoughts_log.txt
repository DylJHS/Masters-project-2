
04/01/24

Thinking about editting the SoI-to-Control-set Wilcoxon Signed Rank test so as to become directional
I may not be able to use the wilcoxon paired test between the SoI and the control sets due the distribution of the difference between the two not being symmetrical around the median. This is because the skeweness of both are the opposite of each other. 
Thinking about intialising a permutation test instead of the Wilcoxon test between the two sets for each control set
Can't use DESeq2 for the paired analysis unless i switch datasets, as it only takes raw RNA-seq counts as input

Creating a preanalysis file for the exploratory analysis the set of interest
started to set up the Contrast analysis to test the SoI-to-Control_set pairings individually
 Should forget the coontrast test given that it might just add complexity to the analysis as opposed to clarifying. Also the result that showed that each of the control sets does deviate significantly from the general trend. Not what I wanted but was confirmed by Adi that this is most likely to be expected given that I am dealing with cancer cells
Finished the Contrast Analysis, the result showed significant difference among the Set pairings (not what i wanted). But can move on. 


05/01/24

Starting to create the permutation paired test in the RNA_Analysis script
Reading up on the Fisher-Pitman permutation test
Considered adding a test for equality of variance following the permutation test, test aren't meant to handle paired data (ex: Levene's). So Choosing to display the variance among the pairings instead as is shown by the violin plots (similarity of widths) in Q1.A
 Making the test one-sided in order to reinforce the interpretation of the analysis
Finished the one-sided paired permutation test between the SoI and Control Set for each Set
Edited the RNA_Analysis to use the same control sets that are used in the charts to maintain a sense of consistency across the analysis


06/01/24


 going to start implementing the changes to the RNA_Analysis to the CNV Analysis
 Changes that will need to be made to the graphs in the script include:
- Converting the names of the samples/pairings on the x axes
- Finding the best colour palettes for the differences by tumour type
- Adding significant p-value indicators to the plots
- Making sure the plots are as understandable as possible

Editing the RNA_Analysis Q2.C to apply a one-sided paired permutation test between the SoI and the control sets when grouping by TSS
And therefore also removing the paired t.test that was in the Analysis previously


07/01/24

- Need to finish the RNA_Analysis up to the point that i can and then convert it for use with the CNV data as well

- Reading up on the multiple correction methods that might be best suited for the paired tests. 
- The type of test is caught between the BH method (large # of tests) & the BY method (as can't truly address the correlation between the tests, or if any are present)
- Likely to go with the BH method unless proven that there are dependencies between the tests
- Should consider switching from one-sided tests to two-sided as the assumption that the SoI showed as general higher expression than other genes was made after seeing the data. 
- Two-sided tests are a bit more conservative
- My initial hypothesis is that these genes show a differential epxression pattern as opposed to solely a higher one
- So switching the tests to two-sided
- Changing the test in Q1.D so that it is not only two-sided but also corrected for using the BH method
- Edited the script in RNA_Analysis Part II in order to upload the entire dataset for the selected control set instead of using filtering the concatenated one
- The use of the full (only selected ~2000 rows of the 11000) allows for better analyses using more of the data
-Need to explore the data some more to check the number of samples for each cancer type and other such analyses that will help determine the types of tests that i can perform
- Should do the above using the Pre_Analysis script 
- All the paired tests grouping by cnacer types come back as siginificant with a pvlaue of 0 for all. This means that plotting them as i had in the previous version won't produce a highly discernable graph as all the points will appear on the same line
- I will use a barplot instead to show the average differential expression by cancer type (TSS) 
- Will also produce the same graph as before on 2 axes but using the diff expression vs the dif copy number once the copy number analysis is achieved
- Broke down the graph in Q2.A into facets based on the TSS group as opposed ot using colour palettes as there are not sufficient colours to cover each type
- Split the RNA_Analysis into 2 separate files for Part I and  Part II
- Created a barploot of the average differences in SoI vs Control Set for each TSS
 

08/01/24

- Editing the Notes file for the Project part I
- Added the interpretation to the mean TSS expression barplot (Q2.D)

-Edited the RNA_Analysis script to replace the 'Differential' terms with 'Difference'
- Considering changing the metric from Difference when assissing the differnces in expression levels to Fold Change (ratio). This might be easier for interpretation given familiarity and removes the factor of the unit seeing as it is solely a relative (comparative) metric, which makes sense for the analyses at hand

- Reading the documetation on the CNV data generated using the GISTIC2.0 method
- Data is represented using log2 ratios
- Positive values indicate a gain in copy number. For instance, a log2 ratio of 1 would suggest a doubling (2^1 = 2) of the copy number in the test sample compared to the reference.
- Negative values indicate a loss in copy number. For example, a log2 ratio of -1 would suggest a halving (2^-1 = 0.5) of the copy number.


09/01/24

- Created the CNV pre-analysis Rmd script
- Analysis of the distribution of the CNV data

- Looking at the distribution of the CNV log2 ratios both the SoI and the Control Sets
- Looking at the distribution of the difference in the CNV values between the sets
- Leaving the RNA units untouched and using the difference in the comparison might be more valuable than assessing the ratio (FC) since I am assessing the sets of different genes and therefore the baseline expression in a ratio wouldn't make much sense
- Think about using tests of variance to show the spread of the data in each of the groupings that get applied
- Creating a Notes for the Part I of the analyses on the CNV data


10/01/24

- Configuring the CNV Analysis past Question 2
- Editing the graphs in both CNV and RNA analysis

- Finish updating the CNV analysis
- update the graphs in the RNA analysis (significance bars)

- Write down the remarks/questioons for Stefan (PPI database pull down cutoff, Permutation tests, negative binomial in the RNA-seq data, differnetial analysis on differnet genes)



11/01/24

- Updat eht egraphs in the RNA analysis
- try to implement some form of PCA 
- Or combine the graphs from the 2 analyses in some way
- Based on the meaning of the interaction score, it might be prudent to set a higher interaction cutoff
- meet with Theo. Advised to renormalise the data 
- should it be normalised per set (SoI & control) or across both (i.e. using the vlaues across both sets as the normalisation parameter)
- Writing the rundown of the presentation
- In order to figure out how to re-normalise the data, figure out how it was normalised in the first place. 
- Was it across rows (samples) or columns (genes) or something different 


12/01/24

- Writing the Rundown for the presentation
- Writing the script for the presentation


13/01/24

- Writing the script for the presentation
- Constructing the Slides for the presentation
- Created a Notes file for the Main Literature References that will be used in my report(s)/presentations



14/01/24

- Using Whimsical for presentation pipeline diagram

- Whimsical is a scam


15/01/24

- Finished the presentation 
- Presented to the Lens & Janssen group


16/01/24

- My Anh's PhD Defense
- Reading up on the different methods for RNASeq normlisation (within&between samples & datasets)


17/01/24

- find out if re-normalisation is truly worth it

- Thinking of not normalising for the inter-set comparison
- But normalising for the intra-set analyses


18/01/24

- Starting the process of figuring out how to renormalise the set-of-interest subset


- Starting on the next Part of the Project (part II)
- Need to cut down the data to the set of interest only while renormalising the data


- In terms of the re-normalisation of the subset of genes it may no longer be a good idea. The process of normalising the data would average out some of the characteristics of the genes in the sample which may not be the best in terms of interpretaiton due to the fact that my hypothesis presumes that the genes in this set are distinct from the rest of the genome. Therefore even an average gene expression in this set could be indicative of something on a wider scale. Also the set is overexpressed when compared to the rest of the genome so lower expressed genes would not appear more like the rest of the genome but would show up as distinct on the lower side. 


- Talk with Stefan
- The iteration testing for the expression data was 'Overkill'
- Only showed what was expected in the most difficult way possible
- The genes of interest are likely just on the higher end of the overall expression histogram
- Using a normal control would prove more evident as that would show that there is a differnece in the expected expression (normal vs cancerous)
- Moving forward suggested to:
- Correlate the genes within the subset to determine if there are genes that are covariates of one-another
- These correlated genes can then be grouped based on a z-score based signature 
- Signature can then be used for further analyses


- Talk did not go well, under the impression that my project is far too simple and convoluted than it should be
- Need to Organise the workflow better
- plan and determine which analyses to implement and why each one of them is beneficial and what they provide individual (i.e. what their purpose is)
- You are only using PanCan data so need to give extra thought to the meaning of the analyses that you are performing 
- Getting a healthy control set would be beneficial to the project as it would provide some basis for the normal functioning of the data that you are looking at

- Was also mentioned that STRING is likely not the best way to go about expanding the list of genes
- Would be more accurate to expand based on specific experimental data from select researchers

- Was slightly condescending
- Think more about finding other resources to assist you or give you suggestions

- Started writing the Gene_Subset_Analyis.Rmd which will contain the analyses for the correlations and the gene signature creation


19/01/24

- Continuing the Correlation analysis

- found a potential dataset for healthy data from different tissue types
- Saved as 'GSE120795_norm_counts_TPM_GRCh38.p13_NCBI.tsv' in the Raw_Data folder
- Copied and saved as 'Healthy_Data' in the RNA_Data folder 
- Data in only composed of RNAseq data 
- The values are normalised using TPM

- Also added the dataset for the values in their raw count form 
- Saved as 'GSE120795_raw_counts_GRCh38.p13_NCBI.tsv.gz' in the Raw_Data folder
- Copied and saved as 'Healthy_Data_raw_counts' in the RNA_Data folder 


- Reading up on GREAT at 'http://great.stanford.edu/public/html/splash.php' 
- This tool may not be relevatn conerning the work that i am doing as it focuses on the cis regulatory regions of the input regions
- Returns the annotation terms that re significanlty associated with the input regions/genes and their cis elements
- My focus is on the gene/regions themselves already knowing the function of most of the genes

- Recall that Stefan also mentioned a means of clustering such as k-means

- Correlated the RNA data using a Pearson correlation score (not measuring the distances but the similarity between the genes)
- Creating a heatmap for the correlation matrix
- Using Bioconductor's 'ComplexHeatmap' package
- 307*307 genes makes for a large matrix
- would like to turn it into a triangle plot seeing as the plot is symmetrical across the diagonal half the plot is redundant

- Would like to follow up the correlation matrix and test using a PCA to identfy the clusters with more precision, create the signature genes and use those signatures as variables instead of the original list of genes which is quite long

- Created the same Correlation analysis file but for the CNV instead of the RNA data
- This seems like it might be the better approach as it comes from the CIN trait (CNV) back to the genetic trait as opposed to grouping by the RNA expression level and then trying to identify specific sets of genes for each 
- This way i am starting from the characteristic that I am interested in, CIN, and grouping at this level in order to identify traits that might be shared by different genes 
- Starting off with the CNV and then adding other CIN metrics to this in order to gain insight

- Need to find a way to break apart the different groupings in the clustermap 
- This will hopefully give me the individual genes that make up each of the groups


20/01/24


- Trying to find ways to extract the relevant clusters from the clusterplot

- Transforming the correlation map into a distance map

- Slightly confused baout how the process will work so here is the rundown of how i see it:
- Create CNV signatures. These signatures are created based on the correlation between the CNVs that are observed in different genes within the data. The genes that are closely related based on the distance matrix (ex: 1 - Pearson's coef) are grouped together using a method such as k-means. 
- Each group makes up a CNV signature. 


21/01/24

- Might be uselful to consider different clustering methods
- K-means clustering beased on the Pearson correlation, but also others such as Mutual Information / Entropy
- Reading up on the methods for correlating RNA and feature extraction
- Thinking that using a Mutual information as the basis for the signatures could be beneficial due to the non-linearity of some of the relation
